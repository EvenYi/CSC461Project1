<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>URTube</title>
    <style>
        .alert-title {
            font-size: 60px;
            font-weight: 900;
            line-height: 32px;
            margin: 30px 0 20px;
            color: #034688;
            display: inline-block;
        }

        .head-background {
            background-image: url('./img/Head_img.jpg');
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-size: 80% 15%;
        }

        .center {
            margin: auto;
            width: 80%;
            border: 3px solid #73AD21;
            padding: 10px;
        }
    </style>
</head>

<body marginheight="0px" marginwidth="0px">
    <script>
        var obj, dbParam, recentvideo, topratevideo, myObj, x, txt = "";
        obj = { "limit": 2 };
        dbParam = JSON.stringify(obj);
        recentvideo = new XMLHttpRequest();
        recentvideo.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                txt += "<tr align='center' style='background-color:#C1CBD7 ;' height='10px'>";
                txt += "<td colspan='5'>Recently Uploaded Videos</td>";
                txt += "</tr>";
                txt += "<tr align='center' style='background-color:#dfd7d7 ;' height='10px'>";
                txt += "<td>Video_name</td>";
                txt += "<td>Video_url</td>";
                txt += "<td>Upload_date</td>";
                txt += "<td>Intro</td>";
                txt += "<td>User_name</td>";
                txt += "</tr>";
                myObj = JSON.parse(this.responseText);
                for (x in myObj) {
                    txt += "<tr align='center' style='background-color:#bfbfbf ;' height='10px'>";
                    txt += "<td><a href='http://betaweb.csug.rochester.edu/~yyang123/video.html?Vid=" + myObj[x].Vid + "''>" + myObj[x].Video_name + "</a></td>";
                    txt += "<td>" + myObj[x].Video_url + "</td>";
                    txt += "<td>" + myObj[x].Upload_date + "</td>";
                    txt += "<td>" + myObj[x].Intro + "</td>";
                    txt += "<td><a href='http://betaweb.csug.rochester.edu/~yyang123/userinfo.html?Uid=" + myObj[x].Uid + "''>" + myObj[x].User_name + "</a></td>";
                    txt += "</tr>";
                }
                txt += "";
                document.getElementById('vidoeTable').innerHTML = txt;

            }
        };
        recentvideo.open("POST", "select_video.php", true);
        recentvideo.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        recentvideo.send("x=" + dbParam);

        obj = { "limit": 10 };

        dbParam = JSON.stringify(obj);
        topratevideo = new XMLHttpRequest();
        topratevideo.onreadystatechange = function () {
            txt = " ";
            if (this.readyState == 4 && this.status == 200) {
                txt += "<tr align='center' style='background-color:#C1CBD7 ;' height='10px'>";
                txt += "<td colspan='5'>Top 5 Rate Videos</td>";
                txt += "</tr>";
                txt += "<tr align='center' style='background-color:#dfd7d7 ;' height='10px'>";
                txt += "<td>Video Name</td>";
                txt += "<td>Rate</td>";
                txt += "</tr>";
                myObj = JSON.parse(this.responseText);
                for (x in myObj) {
                    txt += "<tr align='center' style='background-color:#bfbfbf ;' height='10px'>";
                    txt += "<td><a href='http://betaweb.csug.rochester.edu/~yyang123/video.html?Vid=" + myObj[x].Vid + "''>" + myObj[x].Video_name + "</a></td>";
                    txt += "<td>" + Number(myObj[x].Rate).toFixed(2) + "</td>";
                    txt += "</tr>";
                }
                txt += "";
                document.getElementById('rateTable').innerHTML = txt;

            }
        };
        topratevideo.open("POST", "top_rate.php", true);
        topratevideo.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        topratevideo.send("x=" + dbParam);

        function searchVideo() {
            var obj, dbParam, searchvideo, myObj, x, txt = "";

            obj = { "content": "a" };
            content = document.getElementById('searchInput').value;
            if (!content) {
                alert("Input cannot be empty");
                return;
            }
            obj.content = content;
            dbParam = JSON.stringify(obj);
            searchvideo = new XMLHttpRequest();
            searchvideo.onreadystatechange = function () {

                if (this.readyState == 4 && this.status == 200) {
                    txt += "<tr align='center' style='background-color:#B5C4B1 ;' height='10px'>";
                    txt += "<td colspan='5'>The search result</td>";
                    txt += "</tr>";
                    txt += "<tr align='center' style='background-color:#dfd7d7 ;' height='10px'>";
                    txt += "<td>Video_name</td>";
                    txt += "<td>Video_url</td>";
                    txt += "<td>Upload_date</td>";
                    txt += "<td>Intro</td>";
                    txt += "<td>User_name</td>";
                    txt += "</tr>";
                    myObj = JSON.parse(this.responseText);
                    for (x in myObj) {
                        txt += "<tr align='center' style='background-color:#bfbfbf ;' height='10px'>";
                        txt += "<td><a href='http://betaweb.csug.rochester.edu/~yyang123/video.html?Vid=" + myObj[x].Vid + "''>" + myObj[x].Video_name + "</a></td>";
                        txt += "<td>" + myObj[x].Video_url + "</td>";
                        txt += "<td>" + myObj[x].Upload_date + "</td>";
                        txt += "<td>" + myObj[x].Intro + "</td>";
                        txt += "<td><a href='http://betaweb.csug.rochester.edu/~yyang123/userinfo.html?Uid=" + myObj[x].Uid + "''>" + myObj[x].User_name + "</a></td>";
                        txt += "</tr>";
                    }
                    txt += "";
                    document.getElementById('searchTable').innerHTML = txt;

                }
            };
            searchvideo.open("POST", "search_video.php", true);
            searchvideo.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            searchvideo.send("x=" + dbParam);

        }


    </script>
    <table width=100% height="770px" style="background-color: #fff;" cellspacing="2">
        <tr>
            <td width="80%" height="15%" style="background-color: #fefefe;" class="head-background">

                <h1 class="alert-title">URTube</h1>

            </td>
            <td width="20%" height="15%" style="background-color:#FFC70A ;">
            </td>
        </tr>
        <tr>
            <td width="80%" height="5%" style="background-color:#fefefe ;">
                <a class=".center" href="http://betaweb.csug.rochester.edu/~yyang123/index.html">Home</a>
            </td>
            <td rowspan="2" width="20%" height="70%" style="background-color:#6aa9ff;">
                <table align="center" width="100% " height="65%" id="rateTable">

                </table>
            </td>
        </tr>
        <tr>
            <td width="80%" height="75%" style="background-color:#fefefe ;">

                <div class="center">
                    <input size="118" type="text" id="searchInput">
                    <button onclick="searchVideo()">Search</button>
                    <table align="center" width="100%" id="searchTable"></table>
                </div>


                <table align="center" width="100% " height="65%" id="vidoeTable">

                </table>

            </td>
        </tr>

        <tr>
            <td colspan="2" width="100%" height="10%" style="background-color: #FFC70A;">Foot<br /></td>
        </tr>

    </table>




</body>

</html>